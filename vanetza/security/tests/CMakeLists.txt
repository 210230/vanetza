include(UseGTest)
find_package(Boost COMPONENTS serialization REQUIRED)

set(VANETZA_MODULE_TEST security)
set(SECURITY_ELEMENTS_SOURCES set_elements.cpp test_elements.cpp)
add_gtest(EccPoint ecc_point.cpp ${SECURITY_ELEMENTS_SOURCES})
add_gtest(PublicKey public_key.cpp ${SECURITY_ELEMENTS_SOURCES})
add_gtest(LengthEncoding length_encoding.cpp ${SECURITY_ELEMENTS_SOURCES})
add_gtest(IntX int_x.cpp ${SECURITY_ELEMENTS_SOURCES})
add_gtest(SubjectInfo subject_info.cpp ${SECURITY_ELEMENTS_SOURCES})
add_gtest(SubjectAttribute subject_attribute.cpp ${SECURITY_ELEMENTS_SOURCES})
add_gtest(Region region.cpp ${SECURITY_ELEMENTS_SOURCES})
add_gtest(ValidityRestriction validity_restriction.cpp ${SECURITY_ELEMENTS_SOURCES})
add_gtest(Signature signature.cpp ${SECURITY_ELEMENTS_SOURCES} web_validator.cpp)
add_gtest(SignerInfo signer_info.cpp ${SECURITY_ELEMENTS_SOURCES})
add_gtest(EncryptionParameter encryption_parameter.cpp ${SECURITY_ELEMENTS_SOURCES})
add_gtest(RecipientInfo recipient_info.cpp ${SECURITY_ELEMENTS_SOURCES})
add_gtest(HeaderField header_field.cpp ${SECURITY_ELEMENTS_SOURCES})
add_gtest(TrailerField trailer_field.cpp ${SECURITY_ELEMENTS_SOURCES} web_validator.cpp)
add_gtest(Payload payload.cpp ${SECURITY_ELEMENTS_SOURCES})
add_gtest(SecuredMessage secured_message.cpp ${SECURITY_ELEMENTS_SOURCES} web_validator.cpp)
